define(function(require, exports, module) {
    'use strict'

    var AllDealsModel = require('/js/models/alldeals'),
        Handlebars = require('Handlebars'),
        Backbone = require('Backbone'),
        _ = require('_'),
        Tmpl = require('/js/template')

    module.exports = Backbone.View.extend({
        el: '#merchant',
        model: AllDealsModel,
        template: Handlebars.compile(Tmpl.all_deals),
        initialize: function() {
            _.bindAll(this, 'buildView')
            AllDealsModel.on('change', this.buildView, this)

            return this
        },
        buildView: function() {
            if (!initData.hasBought) {
                this.$el.find('#loading_tips').before(this.template(this.model.toJSON()))
            } else {
                this.$el.find('#loading_tips').remove()
                this.$el.append(this.template(this.model.toJSON()))
            }
        }
    })
})
