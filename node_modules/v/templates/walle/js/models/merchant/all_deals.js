var eve = eve || {},
    merchant = eve.merchant = eve.merchant || {},
    initParams = initParams || '';

;(function() {
    'use strict'

    var detailModel = merchant.detailModel

    // merchant all deals model
    var AllDealsModel = Backbone.Model.extend({
        urlRoot: function() {
            return ( HOST + 'deal/search/substore/' + detailModel.get('bizloginid') ) + initParams
        },
        parse: function(res) {
            if (res && res.data && _.isArray(res.data)) {
                res.data.forEach(function(deal) {
                    var mname = deal.mname,
                        price = deal.price,
                        reg = new RegExp("^" + mname + "(:|：)")

                    deal.title = deal.title.replace(reg, function() {
                        return "仅售" + price + "元！"
                    })
                })
            }

            return res
        }
    })

    merchant.AllDealsModel = new AllDealsModel
}())
