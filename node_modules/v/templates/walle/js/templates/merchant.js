var eve = eve || {}

;(function() {
    'use strict'

    // 这里之所以不用驼峰命名法，是与他们的容器保持一致
    var merchant = {
        detail: '\
            <section id="detail" class="detail">\
                <header>{{name}}</header>\
                <section id="map" class="map">\
                    <a href="{{mapLink}}">\
                        <img id="map_canvas" class="map-canvas" height="{{staticMap.height}}" width="{{staticMap.width}}" src="http://st.map.soso.com/api?size={{staticMap.width}}*{{staticMap.height}}&center={{lng}},{{lat}}&zoom=14&markers={{lng}},{{lat}}"/>\
                    </a>\
                </section>\
                <section class="contact-info">\
                    <ul class="c-list">\
                        <li class="address">\
                            <a class="c-item" href="{{mapLink}}">\
                                <div class="c-item-prefix icon-location"></div>\
                                <div class="c-item-content">\
                                    <address>{{addr}}</address>\
                                </div>\
                                <div class="c-item-suffix icon-right"></div>\
                            </a>\
                        </li>\
                        <li class="phone">\
                            <a id="call_phone" data-phone={{phone}} {{telPhone}}  class="c-item">\
                                <div class="c-item-prefix icon-phone"></div>\
                                <div class="c-item-content">\
                                    <p>{{phone}}</p>\
                                </div>\
                                <div class="c-item-suffix icon-right"></div>\
                            </a>\
                        </li>\
                    {{#unless isIpad}}\
                        <li class="direction">\
                            <a class="c-item" href="{{mapLink}}">\
                                <div class="c-item-prefix icon-traffic"></div>\
                                <div class="c-item-content">\
                                    <p>查看路线</p>\
                                </div>\
                                <div class="c-item-suffix icon-right"></div>\
                            </a>\
                        </li>\
                    {{/unless}}\
                    </ul>\
                </section>\
            </section>\
            {{#if isMovie}}\
            <section class="cinema">\
                <header>\
                    <!-- TODO 修改icon 和 链接地址 -->\
                    <a href="imeituan://www.meituan.com/deal/movieshow">\
                        <div class="c-item-content">\
                            <span class="icon-list"></span>影院排片表\
                        </div>\
                        <div class="c-item-suffix icon-right"></div>\
                    </a>\
                </header>\
            </section>\
            {{/if}}\
        '
        , pop_phone: '\
            <section id="pop_wrapper" class="pop-wrapper">\
                 <div id="mask" class="mask"></div>\
                 <ul id="pop_content" class="pop-content">\
                     {{#each this}}\
                     <li>\
                         <a class="c-item" href="tel:{{phone}}">\
                            <div class="c-item-prefix icon-phone"></div>\
                            <div class="c-item-content">\
                                <p>{{phone}}</p>\
                            </div>\
                            <div class="c-item-suffix icon-right"></div>\
                         </a>\
                    </li>\
                     {{/each}}\
                 </ul>\
             </section>\
        '
        , all_deals: '\
            {{#if-greater-zero data}}\
            <section id="all_deals" class="all-deals">\
                <header><span class="icon-list"></span>本店团购</header>\
                {{#c-list data}}\
                  <a class="c-item" href="imeituan://www.meituan.com/deal?did={{slug}}">\
                      <div class="c-item-content">\
                        <p>{{title}}</p>\
                      </div>\
                      <div class="c-item-suffix icon-right"></div>\
                  </a>\
                {{/c-list}}\
            </section>\
            {{/if-greater-zero}}\
        '
        , nearby_deals: '\
            {{#if-greater-zero data}}\
            <section id="nearby_deals" class="nearby-deals">\
                <header><span class="icon-nearby"></span>附近团购</header>\
                {{#c-list data}}\
                    {{#if slug}}\
                    <a class="c-item" href="imeituan://www.meituan.com/deal?did={{slug}}">\
                    {{else}}\
                    <a class="c-item more-deals">\
                    {{/if}}\
                        <div class="c-item-content">\
                            <header>\
                                <h6>{{mname}}</h6>\
                                {{#if distance}}\
                                    <p><{{distance}}</p>\
                                {{/if}}\
                            </header>\
                            <p>{{title}}</p>\
                        </div>\
                        <div class="c-item-suffix icon-right"></div>\
                    </a>\
                {{/c-list}}\
            </section>\
            {{/if-greater-zero}}\
        '
        , current_price: '\
            <section id="current_price" class="current-price">\
                <p id="price" class="price">{{price}}元<del id="value" class="value">{{value}}元</del></p>\
                <a href="imeituan://www.meituan.com/buy?from=dealGallery&dealId={{dealId}}">\
                    <div class="buy-btn">\
                        立即抢购\
                    </div>\
                </a>\
            </section>\
        '
        , movie_schedule: '\
            <section id="movie_schedule" class="movie-schedule">\
                {{#menu current}}{{/menu}}\
                {{#if errMsg}}\
                    <p class="errMsg">{{errMsg}}</p>\
                {{else}}\
                <ul id="container" class="container">\
                {{#each schedule}}\
                    <li class="movie">\
                        <a href="meituanmovie://www.meituan.com/movie?id={{id}}&nm={{name}}" class="name">\
                            <div class="c-item-content">{{name}}</div>\
                            <!-- TODO 这里的HTML结构可能需要调整 -->\
                            <div class="c-item-suffix">\
                                <span class="dur">{{duration}}分钟<span class="icon-right"><span></span></span></span>\
                            </div>\
                        </a>\
                        <ul class="type-list">\
                        {{#each types}}\
                            <li class="movie-type">\
                                <h6>{{this}}</h6>\
                                {{{timelist ../this ../../this.current}}}\
                            </li>\
                        {{/each}}\
                        </ul>\
                    </li>\
                {{/each}}\
                </ul>\
            </section>\
            {{/if}}\
        '
    }

    eve.merchant = {
        tmpl: merchant
    }
})()
